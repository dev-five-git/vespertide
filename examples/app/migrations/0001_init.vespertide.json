{
  "$schema": "https://raw.githubusercontent.com/dev-five-git/vespertide/refs/heads/main/schemas/migration.schema.json",
  "actions": [
    {
      "columns": [
        {
          "default": "gen_random_uuid()",
          "name": "id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "index": true,
          "name": "email",
          "nullable": false,
          "type": {
            "kind": "varchar",
            "length": 255
          },
          "unique": true
        },
        {
          "name": "password",
          "nullable": false,
          "type": {
            "kind": "varchar",
            "length": 255
          }
        },
        {
          "name": "name",
          "nullable": false,
          "type": {
            "kind": "varchar",
            "length": 100
          }
        },
        {
          "name": "profile_image",
          "nullable": true,
          "type": "text"
        },
        {
          "default": "now()",
          "name": "created_at",
          "nullable": false,
          "type": "timestamptz"
        },
        {
          "name": "updated_at",
          "nullable": true,
          "type": "timestamptz"
        }
      ],
      "constraints": [],
      "table": "user",
      "type": "create_table"
    },
    {
      "columns": [
        {
          "comment": "hello",
          "default": "gen_random_uuid()",
          "name": "id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "name": "name",
          "nullable": false,
          "type": {
            "kind": "varchar",
            "length": 100
          }
        },
        {
          "name": "description",
          "nullable": true,
          "type": "text"
        },
        {
          "name": "logo",
          "nullable": true,
          "type": "text"
        },
        {
          "foreign_key": {
            "on_delete": "cascade",
            "on_update": null,
            "ref_columns": [
              "id"
            ],
            "ref_table": "user"
          },
          "index": true,
          "name": "owner_id",
          "nullable": false,
          "type": "uuid"
        },
        {
          "default": "now()",
          "name": "created_at",
          "nullable": false,
          "type": "timestamptz"
        },
        {
          "name": "updated_at",
          "nullable": true,
          "type": "timestamptz"
        }
      ],
      "constraints": [],
      "table": "media",
      "type": "create_table"
    },
    {
      "columns": [
        {
          "foreign_key": {
            "on_delete": "cascade",
            "on_update": null,
            "ref_columns": [
              "id"
            ],
            "ref_table": "media"
          },
          "name": "media_id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "name": "id",
          "nullable": false,
          "primary_key": true,
          "type": "big_int"
        },
        {
          "name": "title",
          "nullable": false,
          "type": {
            "kind": "varchar",
            "length": 500
          }
        },
        {
          "name": "content",
          "nullable": false,
          "type": "text"
        },
        {
          "name": "summary",
          "nullable": true,
          "type": "text"
        },
        {
          "name": "thumbnail",
          "nullable": true,
          "type": "text"
        },
        {
          "default": "'draft'",
          "index": true,
          "name": "status",
          "nullable": false,
          "type": {
            "kind": "enum",
            "name": "status",
            "values": [
              "draft",
              "review",
              "published",
              "archived"
            ]
          }
        },
        {
          "index": true,
          "name": "published_at",
          "nullable": true,
          "type": "timestamptz"
        },
        {
          "default": "now()",
          "name": "created_at",
          "nullable": false,
          "type": "timestamptz"
        },
        {
          "name": "updated_at",
          "nullable": true,
          "type": "timestamptz"
        }
      ],
      "constraints": [],
      "table": "article",
      "type": "create_table"
    },
    {
      "columns": [
        {
          "comment": "hello",
          "foreign_key": {
            "on_delete": "cascade",
            "on_update": null,
            "ref_columns": [
              "id"
            ],
            "ref_table": "user"
          },
          "index": true,
          "name": "user_id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "foreign_key": {
            "on_delete": "cascade",
            "on_update": null,
            "ref_columns": [
              "id"
            ],
            "ref_table": "media"
          },
          "index": true,
          "name": "media_id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "index": true,
          "name": "role",
          "nullable": false,
          "type": {
            "kind": "enum",
            "name": "role",
            "values": [
              "owner",
              "editor",
              "reporter"
            ]
          }
        },
        {
          "default": "now()",
          "name": "created_at",
          "nullable": false,
          "type": "timestamptz"
        }
      ],
      "constraints": [],
      "table": "user_media_role",
      "type": "create_table"
    },
    {
      "columns": [
        {
          "name": "media_id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "name": "article_id",
          "nullable": false,
          "primary_key": true,
          "type": "big_int"
        },
        {
          "foreign_key": {
            "on_delete": "cascade",
            "on_update": null,
            "ref_columns": [
              "id"
            ],
            "ref_table": "user"
          },
          "index": true,
          "name": "user_id",
          "nullable": false,
          "primary_key": true,
          "type": "uuid"
        },
        {
          "default": "1",
          "name": "author_order",
          "nullable": false,
          "type": "integer"
        },
        {
          "default": "'contributor'",
          "name": "role",
          "nullable": false,
          "type": {
            "kind": "enum",
            "name": "role",
            "values": [
              "lead",
              "contributor"
            ]
          }
        },
        {
          "default": "now()",
          "name": "created_at",
          "nullable": false,
          "type": "timestamptz"
        }
      ],
      "constraints": [
        {
          "columns": [
            "media_id",
            "article_id"
          ],
          "on_delete": "cascade",
          "on_update": null,
          "ref_columns": [
            "media_id",
            "id"
          ],
          "ref_table": "article",
          "type": "foreign_key"
        }
      ],
      "table": "article_user",
      "type": "create_table"
    }
  ],
  "comment": "init",
  "created_at": "2026-02-23T12:40:21Z",
  "id": "3e051b39-2716-438d-bdd0-32e41da4fb47",
  "version": 1
}